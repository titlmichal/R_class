.by = variable)
df_long <- df %>%
select(all_of(variables)) %>%
pivot_longer(everything(),
names_to = "variable") %>%
mutate(value = as.double(scale(value)),
.by = variable)
df_long %>%
drop_na() %>%
group_by(variable) %>%
summarise(
m = mean(value),
sd = sd(value)
)
df_long %>%
ggplot(aes(value)) +
geom_histogram(aes(y = after_stat(density)),
binwidth = .25) +
facet_wrap(~variable) +
stat_function(fun = dnorm,
color = "red",
linewidth = 1)
df_long %>%
ggplot(aes(value)) +
geom_histogram(aes(y = after_stat(density)),
binwidth = .25) +
facet_wrap(~variable) +
stat_function(fun = dnorm,
color = "red",
linewidth = 1)
df_long %>%
ggplot(aes(value)) +
geom_density(color = "blue") +
facet_wrap(~variable) +
stat_function(fun = dnorm,
color = "red",
linewidth = 1)
df_long %>%
ggplot(aes(value)) +
geom_density(color = "blue") +
facet_wrap(~variable) +
stat_function(fun = dnorm,
color = "red",
linewidth = 1,
linetype = "11")
df_long %>%
ggplot(aes(value)) +
geom_histogram(aes(y = after_stat(density)),
binwidth = .25) +
facet_wrap(~variable) +
stat_function(fun = dnorm,
color = "red",
linewidth = 1)
df_long %>%
ggplot(aes(sample = value)) +
geom_qq_line() +
geom_qq() +
facet_wrap(~variable)
df_long %>%
ggplot(aes(value)) +
geom_histogram(aes(y = after_stat(density)),
binwidth = .25) +
facet_wrap(~variable) +
stat_function(fun = dnorm,
color = "red",
linewidth = 1)
df_long %>%
ggplot(aes(value)) +
geom_density(color = "blue") +
facet_wrap(~variable) +
stat_function(fun = dnorm,
color = "red",
linewidth = 1,
linetype = "11")
# Funce corr.test() z balíčku psych
out <- psych::corr.test(df_cor)
# -----------------Balíčej psych
#base R nedává další metriky ke korelacím (CIs, p values a tak)
# Funce corr.test() z balíčku psych
out <- psych::corr.test(df_cor)
print(out, short = FALSE)
str(out)
out$stars
print(out, short = FALSE)       #vytisknou (a delší formát vč. CIs)
psych::corr.test(df_cor)
psych::corr.test(df_cor,
adjust = "holm", # jakou korekci p-hodnot použít
method = "spearman", # typ korelačního koef
alpha = 0.005) %>% # hladina spolehlivosti bude 1 - alpha
print(short = FALSE)
psych::corr.test(df_cor,
adjust = "holm", # jakou korekci p-hodnot použít
method = "spearman", # typ korelačního koef
alpha = 0.01) %>% # hladina spolehlivosti bude 1 - alpha
print(short = FALSE)
str(out)
out$stars
print(out, short = FALSE)
# Korelogramy pomocí balíčku corrplot a stejnojmenné funkce corplot()
r_mat <- cor(df_cor, use = "pairwise")
r_mat # korelační matice
corrplot::corrplot(r_mat)
corrplot::corrplot(r_mat,
method = "number",
order = "hclust")
corrplot::corrplot(r_mat)
corrplot::corrplot(r_mat,
method = "number",
order = "hclust")
corrplot::corrplot(r_mat,
method = "number", #definujeme formu zobrazení
order = "hclust")
corrplot::corrplot.mixed(r_mat,
lower = "number",
upper = "ellipse",
lower.col = "black",
order = "hclust")
corrplot::corrplot.mixed(r_mat,
lower = "number",
upper = "ellipse",
lower.col = "black",
order = "hclust") #zde seřazení dle podobnosti vztahů
corrplot::corrplot(r_mat,
method = "number", #definujeme formu zobrazení
order = "hclust")
# Network plots
#když bychom jich měli už moc
#stačí tady korelace vytvořené base R cor
df_cor <- df %>%
select(warm_m:neshody)
names(df_cor)
r_mat <- cor(df_cor,
use = "pairwise",
method = "spearman")
diag(r_mat) <- 0
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .1,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
# Network plots
#když bychom jich měli už moc
#stačí tady korelace vytvořené base R cor
df_cor <- df %>%
select(warm_m:neshody)
names(df_cor)
r_mat <- cor(df_cor,
use = "pairwise",
method = "spearman")
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .1,
repulsion = .1,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .1,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .1,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
diag(r_mat) <- 0
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .2,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 5)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 1)
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
#repulsion je pro layout --> určuje, jak moc jsou nody od sebe "odpuzovány"
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .00001,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
#repulsion je pro layout --> určuje, jak moc jsou nody od sebe "odpuzovány"
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .99,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
#repulsion je pro layout --> určuje, jak moc jsou nody od sebe "odpuzovány"
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = 5,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
#repulsion je pro layout --> určuje, jak moc jsou nody od sebe "odpuzovány"
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = 5000,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
#repulsion je pro layout --> určuje, jak moc jsou nody od sebe "odpuzovány"
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .0000000000000002,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
#repulsion je pro layout --> určuje, jak moc jsou nody od sebe "odpuzovány"
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,
DŮV = 4:5,
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
#layout spring dává k sobě blízce korelující
#treshold specifikuje hladinu korelací, pod kterou nezobrazuje
#repulsion je pro layout --> určuje, jak moc jsou nody od sebe "odpuzovány"
qgraph(r_mat,
layout = "spring",
theme = "colorblind",
threshold = .2,
repulsion = .7,
groups = list(VŘE = 1:2,   #argument groups specifikuje barevné odlišení
DŮV = 4:5,   #a které proměnné tvoří ty skupiny
IND = 7:9,
NEG = 10:12,
CRO = 14:16,
CSK = 17:20,
VM = 26:28),
labels = c("VŘ.M", "VŘ.O", "MON", "DUV.R", "DUV.V", "VZsR", "IND.1", "IND.2",
"IND.3", "NEG.1", "NEG.2", "NEG.3", "ROD.E", "ROD.P", "ROD.A", "R.S",
"ŠK.E", "ŠK.P", "ŠK.A", "ŠK.S", "OPT", "ZSP", "EST", "EFF",
"PSS", "VM.U", "VM.S", "VM.N", "DEP", "NESH"),
GLratio = 9) #vzdálenost legendy, resp poměr grafu a legendy
names(df_cor)
